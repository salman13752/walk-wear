<%-include("../../views/partials/user/header")%>

  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
 <link rel="stylesheet" href="../../css/user/productDetails.css">
  <style>
   
  </style>
</head>
<body>
<div class="pd-wrap">
  <div class="container">
    <div class="heading-section">
      <h2>Product Details</h2>
    </div>
    <div class="row">
      <!-- Image Section -->
      <div class="col-md-6">
        <div id="slider" class="owl-carousel product-slider">
          <% product.productImage.forEach((image) => { %>
            <div class="item">
              <img src="<%= image %>" alt="Product Image">
            </div>
          <% }) %>
        </div>
        <div id="thumb" class="owl-carousel product-thumb">
          <% product.productImage.forEach((image) => { %>
            <div class="item">
              <img src="<%= image %>" alt="Thumbnail">
            </div>
          <% }) %>
        </div>
      </div>
      
      <!-- Product Details Section -->
      <div class="col-md-6">
        <div class="product-dtl">
          <div class="product-info">
            <div class="product-name">
              <h1><%= product.productName %></h1>
            </div>
            <div class="reviews-counter">
              <div class="rate" style="pointer-events: none;"> <!-- Disables interaction -->
                <input type="radio" id="star5" name="rate" value="5" disabled>
                <label for="star5" title="5 stars">★</label>
                <input type="radio" id="star4" name="rate" value="4" checked disabled>
                <label for="star4" title="4 stars">★</label>
                <input type="radio" id="star3" name="rate" value="3" disabled>
                <label for="star3" title="3 stars">★</label>
                <input type="radio" id="star2" name="rate" value="2" disabled>
                <label for="star2" title="2 stars">★</label>
                <input type="radio" id="star1" name="rate" value="1" disabled>
                <label for="star1" title="1 star">★</label>
              </div>
              <span>(3 Reviews)</span>
            </div>
            
            <div class="product-price-discount">
              <span id="currentPrice">₹<%= product.combos[0].salePrice %></span>
              <span id="regularPrice" class="line-through">₹<%= product.combos[0].regularPrice %></span>
            </div>
          </div>
          <p><%= product.description || 'No description available.' %></p>
         

          <div class="container mt-4">
            <div class="product-count">
                <label for="quantity" class="form-label fw-bold">Quantity</label>
                <div class="input-group">
                    <button class="btn btn-outline-primary qtyminus">−</button>
                    <input style="width: 25px;" type="text" name="quantity" value="1" class="text-center quantity" id="quantity">
                    <button class="btn btn-outline-primary qtyplus">+</button>
                </div>
            </div>
            <div class="stock-info" id="quantityStatus">
              <% if (product.combos[0].quantity <= 0) {%>
                Stock: <h5 class="text-danger">out of stock</h5>
                <%}else { %>              
                Stock: <%= product.combos[0].quantity %>
                <%}%>
            </div>
        </div>
        

          <div class="container">
            <div class="row">
              <div class="col-md-12 text-center">            
                <button class="btn btn-primary btn-sm w-10" onclick="addToCart('<%=product._id%>','<%=product.combos[0]._id%>')" >Add to Cart</button>
              </div>
            </div>
          </div>
        
      
        
          <div class="details__size flex">
            <ul class="size__list">
              <h5>Size</h5>
                <% product.combos.forEach((combo, index) => { %>
                  <button class="btn btn-primary" 
                    type="button"
                    data-product-id="<%= product._id %>"
                    data-combos-id="<%= combo._id %>"
                    data-size="<%= combo.Size %>"
                    class="size__link <%= index === 0 ? 'size__link size-active' : 'size__link' %> combo-option"
                    aria-label="Select combo: <%= combo.Size %>"
                    onclick="selectCombo(this)"
                  >
                    <%= combo.Size %>
                  </button>
                <% }); %>
              
            </ul>
          </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    

    <div class="bottom-section">
      <div class="description-section">
        <h3>Product Description</h3>
        <h5>Product details</h5>
<div style="line-height: 1.8;"> 
  <p><strong>Closure type:</strong> Lace-Up</p>
  <p><strong>Heel type:</strong> Flat</p>
  <p><strong>Water resistance level:</strong> Not Water Resistant</p>
  <p><strong>Sole material:</strong> Ethylene Vinyl Acetate</p>
  <p><strong>Style:</strong> Running</p>
  <p><strong>Country of Origin:</strong> India</p>
</div>
      </div>
      <div class="review-section">
        <div class="customer-review">
          <h2>Customer Review</h2>
          <div style="border: 1px solid #ddd; padding: 20px; border-radius: 5px; margin-top: 10px;">
            <h3 style="margin: 0; font-size: 1.2em;">⭐⭐⭐⭐⭐ (5/5)</h3>
            <p style="font-style: italic;"><strong>"Amazing Quality and Comfort!"</strong></p>
            <p>
              I recently purchased these shoes, and I couldn't be happier! The <strong>Lace-Up closure</strong> ensures a snug fit, 
              and the <strong>flat heel</strong> makes it super comfortable for daily wear. Even though it's labeled as 
              <strong>not water-resistant</strong>, I found that it holds up pretty well in light rain.
            </p>
            <p>
              The <strong>EVA sole material</strong> provides excellent cushioning, and the <strong>running style</strong> is 
              perfect for both casual outings and light jogging. Bonus points for being made in <strong>India</strong>, as I 
              always try to support locally made products.
            </p>
            <p style="font-weight: bold; margin: 0;">Highly recommend it to anyone looking for a stylish and comfortable pair of shoes!</p>
          </div>
        </div>
        
      </div>
    </div>
  </div>
</div>

<div class="container mt-5" >
  <h3 class="mb-4 text-white">Related Products</h3>
  <div class="row">
      <% relatedProducts.forEach(function(relatedProduct) { %>
          <div class="col-md-4 mb-4">
              <div class="card" style="width: 300px;">
                  <img src="<%= relatedProduct.productImage[0] %>" alt="<%= relatedProduct.name %>" class="card-img-top" style="height: 300px"  />
                  <div class="card-body">
                      <a href="/productDetails/<%= relatedProduct._id %>" class="text-decoration-none text-dark">
                          <h5 class="card-title"><%= relatedProduct.productName %></h5>
                      </a>
                      <p class="card-text">Price: <%= relatedProduct.combos[0].salePrice %></p>
                      <p class="card-text">Size: <%= relatedProduct.combos[0].Size %></p>
                      <button class="btn btn-primary w-100">Add to Cart</button>
                  </div>
              </div>
          </div>
      <% }); %>
  </div>
</div>
<%-include("../../views/partials/user/footer")%>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/@panzoom/panzoom@4.5.0/dist/panzoom.min.js"></script>
<script src="../../admin.js/size.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
<script src="../../admin.js/productD.js"></script>
<script src="../../user.js/main.js"></script>
<script>
 document.addEventListener("DOMContentLoaded", function () {
    // Get stock availability from the page
    const stockAvailable = parseInt(document.querySelector("#quantityStatus").textContent.replace("Stock: ", "").trim());

    document.querySelector(".qtyminus").addEventListener("click", function () {
        let qty = document.querySelector("#quantity");
        let value = parseInt(qty.value);
        if (value > 1) qty.value = value - 1;
    });

    document.querySelector(".qtyplus").addEventListener("click", function () {
        let qty = document.querySelector("#quantity");
        let value = parseInt(qty.value);
        if (value < stockAvailable) { // Prevent exceeding stock
            qty.value = value + 1;
        }
    });

    // Ensure manual input does not exceed stock
    document.querySelector("#quantity").addEventListener("input", function () {
        let qty = document.querySelector("#quantity");
        let value = parseInt(qty.value) || 1;
        if (value > stockAvailable) {
            qty.value = stockAvailable;
        } else if (value < 1) {
            qty.value = 1;
        }
    });
});


</script>
</body>
</html>